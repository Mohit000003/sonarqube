# sonarqube

How to Install SonarQube on Ubuntu 22.04 (Step-by-Step Guide)
This guide will help you install and run SonarQube on Ubuntu 22.04, accessible on http://localhost:9000.

Step 1: Update the System
Before installing SonarQube, update and upgrade your system packages:

sh
Copy
Edit
sudo apt update && sudo apt upgrade -y
Step 2: Install Java 17 (Required for SonarQube)
SonarQube requires Java 17, so install OpenJDK 17:

sh
Copy
Edit
sudo apt install openjdk-17-jdk -y
Check Java version:

sh
Copy
Edit
java -version
Expected output:

nginx
Copy
Edit
openjdk version "17.0.x"
Step 3: Install PostgreSQL (Required for Production)
SonarQube recommends using PostgreSQL 12+ as its database.
Install PostgreSQL:

sh
Copy
Edit
sudo apt install postgresql postgresql-contrib -y
Start and enable PostgreSQL service:

sh
Copy
Edit
sudo systemctl start postgresql
sudo systemctl enable postgresql
Create a Database for SonarQube
Switch to the PostgreSQL user:

sh
Copy
Edit
sudo -i -u postgres
Run the following PostgreSQL commands:

psql
Copy
Edit
CREATE USER sonar WITH ENCRYPTED PASSWORD 'sonar';
CREATE DATABASE sonarqube OWNER sonar;
ALTER USER sonar WITH SUPERUSER;
Exit PostgreSQL:

\q
Copy
Edit
exit
Step 4: Create a Dedicated SonarQube User
Create a system user to run SonarQube:

sh
Copy
Edit
sudo adduser --system --no-create-home --group sonar
Step 5: Download and Extract SonarQube
Navigate to the /opt directory:

sh
Copy
Edit
cd /opt
Download the latest SonarQube Community Edition:

sh
Copy
Edit
sudo wget https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-9.9.1.69595.zip
(Replace the version number with the latest one from SonarQube Downloads)

Install unzip (if not installed)
sh
Copy
Edit
sudo apt install unzip -y
Extract SonarQube
sh
Copy
Edit
sudo unzip sonarqube-9.9.1.69595.zip
Rename the extracted folder:

sh
Copy
Edit
sudo mv sonarqube-9.9.1.69595 sonarqube
Change ownership to the sonar user:

sh
Copy
Edit
sudo chown -R sonar:sonar /opt/sonarqube
Step 6: Configure SonarQube
Edit the SonarQube configuration file:

sh
Copy
Edit
sudo nano /opt/sonarqube/conf/sonar.properties
Find and update the database settings:

ini
Copy
Edit
sonar.jdbc.username=sonar
sonar.jdbc.password=sonar
sonar.jdbc.url=jdbc:postgresql://localhost:5432/sonarqube
sonar.web.host=0.0.0.0
sonar.web.port=9000
Save the file (CTRL + X, then Y, then ENTER).

Step 7: Create a Systemd Service for SonarQube
Create a new systemd service file:

sh
Copy
Edit
sudo nano /etc/systemd/system/sonarqube.service
Paste the following content:

ini
Copy
Edit
[Unit]
Description=SonarQube service
After=syslog.target network.target

[Service]
Type=simple
ExecStart=/opt/sonarqube/bin/linux-x86-64/sonar.sh console
User=sonar
Group=sonar
Restart=always
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target
Save and exit (CTRL + X, then Y, then ENTER).

Reload systemd and start SonarQube:

sh
Copy
Edit
sudo systemctl daemon-reload
sudo systemctl enable sonarqube
sudo systemctl start sonarqube
Check the status:

sh
Copy
Edit
sudo systemctl status sonarqube
You should see Active: running.

Step 8: Allow Port 9000 in the Firewall
If you have UFW (Uncomplicated Firewall) enabled, allow port 9000:

sh
Copy
Edit
sudo ufw allow 9000/tcp
sudo ufw reload
Step 9: Access SonarQube
Now, open your browser and go to:
ðŸ‘‰ http://localhost:9000

Login with the default credentials:

Username: admin
Password: admin
After logging in, you will be prompted to change the password.

Step 10: Troubleshooting (If SonarQube Fails to Start)
Check SonarQube Logs
If SonarQube doesnâ€™t start, check the logs:

sh
Copy
Edit
sudo journalctl -u sonarqube -f
Increase System Limits (If Needed)
Run the following command:

sh
Copy
Edit
echo "sonar - nofile 65536" | sudo tee -a /etc/security/limits.conf
Check Java Version
Make sure you are using Java 17:

sh
Copy
Edit
java -version
SonarQube Directory Structure
After installation, your SonarQube directory should look like this:

bash
Copy
Edit
/opt/sonarqube
â”‚-- bin/                  # Startup scripts for different OS
â”‚   â”œâ”€â”€ linux-x86-64/     # Linux-specific startup script
â”‚   â”œâ”€â”€ macosx-universal/ # MacOS-specific startup script
â”‚   â”œâ”€â”€ windows-x86-64/   # Windows-specific startup script
â”‚-- conf/                 # Configuration files (sonar.properties, wrapper.conf)
â”‚-- data/                 # SonarQube data (indexes, settings, etc.)
â”‚-- elasticsearch/        # Embedded Elasticsearch for search
â”‚-- extensions/           # Plugins and additional functionalities
â”‚-- lib/                  # Libraries
â”‚-- logs/                 # Logs generated by SonarQube
â”‚-- temp/                 # Temporary files
ðŸŽ‰ SonarQube is Now Installed and Running on Ubuntu 22.04!
ðŸ‘‰ Access it via: http://localhost:9000
Let me know if you face any issues! ðŸš€
